esphome:
  name: book-nook-portion
  friendly_name: book-nook-portion
  on_boot:
    priority: -10
    then:
      - logger.log: "Starte â€“ warte kurz (OTA/Logs)..."
      - delay: 10min  # kleines Fenster fÃ¼r OTA/Diagnose
      - logger.log: "â˜€ï¸ Tag erkannt -> Deep Sleep 30min"
      - deep_sleep.enter:
          id: deepsleep_ctrl
          sleep_duration: 1min

esp8266:
  board: nodemcu

# Enable logging
logger:

# Enable Home Assistant API
api:
  encryption:
    key: "zgaW+hh3tXzLizRniNi6zSnvQPc4ulVN4a0SdHUyxTc="

ota:
  - platform: esphome
    password: "19b49a990fba75efd13d8ca035962d9a"

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: "Book-Nook-Portion"
    password: "PmsuQSdpFwML"

captive_portal:

web_server:



sun:
  latitude: 50.9383Â°
  longitude: 6.9599Â°

deep_sleep:
  id: deepsleep_ctrl

time:
  - platform: sntp

interval:
  - interval: 5s
    then:
      - if:
          condition:
            sun.is_above_horizon
          then:
            - logger.log: "â˜€ï¸ Tag -> gehe schlafen"
            - deep_sleep.enter:
                id: deepsleep_ctrl
                sleep_duration: 30min
          else:
            - logger.log: "ðŸŒ™ Nacht -> wach bleiben"

output:
  - platform: gpio
    pin: GPIO5   # D1
    id: led1_out
  - platform: gpio
    pin: GPIO4   # D2
    id: led2_out
  - platform: gpio
    pin: GPIO0   # D3
    id: led3_out
  - platform: gpio
    pin: GPIO2   # D4
    id: led4_out
  - platform: gpio
    pin: GPIO14  # D5
    id: led5_out

# ------------------------------
# Lichter als Schalter anzeigen
# ------------------------------
light:
  - platform: binary
    name: "LED 1"
    output: led1_out
    restore_mode: ALWAYS_ON
  - platform: binary
    name: "LED 2"
    output: led2_out
    restore_mode: ALWAYS_ON
  - platform: binary
    name: "LED 3"
    output: led3_out
    restore_mode: ALWAYS_ON
  - platform: binary
    name: "LED 4"
    output: led4_out
    restore_mode: ALWAYS_ON
  - platform: binary
    name: "LED 5"
    output: led5_out
    restore_mode: ALWAYS_ON
    